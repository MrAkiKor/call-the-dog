<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Running Game with AI Opponent and Pause Feature</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }
    #game-area {
      margin-top: 20px;
      width: 80%;
      height: 150px;
      border: 2px solid black;
      position: relative;
      overflow: hidden;
      margin: auto;
      background-color: #faf5f9;
    }

    .floor {
      background-color: #5b5b5d;
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 33%;
    }
    .runner {
      position: absolute;
      bottom: 20px;
      width: 50px;
      height: 50px;
      background-size: cover;
      background-repeat: no-repeat;
    }
    #player {
      background-image: url('./player2.png');
      background-position: 0 0px; /* Start with the first frame */
      left: 0;
      background-size: 300px;
      transition: left 0.15s;
    }
    #ai {
      background-color: red;
      left: 0;
      bottom: 10px;
    }
    #instructions {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>Running Game with AI Opponent and Pause Feature</h1>
<div id="instructions">
  Press "J" and "K" alternately to make your runner move forward! Press "P" to pause or resume the game.
</div>
<div id="game-area">
  <div class="floor"></div>
  <section class="background">
  </section>
  <div id="player" class="runner"></div>
  <div id="ai" class="runner"></div>
</div>
<div id="distance">Player Distance: 0% | AI Distance: 0%</div>

<script>
  const player = document.getElementById('player');
  const ai = document.getElementById('ai');
  const distanceDisplay = document.getElementById('distance');
  
  let playerDistance = 0;
  let aiDistance = 0;
  let lastKey = ''; // Track the last key pressed by the player
  const goal = 100; // Distance goal to win the game (100%)
  const aiSpeed = 1.3; // AI moves 0.5% of the game area per interval
  let isPaused = false; // Game starts unpaused

  // Sprite animation settings
  const spriteWidth = 300 / 5; // Each frame width is 75px (300px / 4 frames)
  const spriteHeight = 128;    // Height of each frame
  let currentFrame = 0;        // Current frame in the sprite sheet
  const frameSpeed = 5;        // Number of key presses between frame changes

  // AI running function
  function aiRun() {
    if (!isPaused) {
      aiDistance += aiSpeed;
      ai.style.left = `${aiDistance}%`;
      updateDistanceDisplay();

      // Check if AI won
      if (aiDistance >= goal) {
        alert('AI won the race!');
        resetGame();
      }
    }
  }
  
  // Update the distance display
  function updateDistanceDisplay() {
    distanceDisplay.textContent = `Player Distance: ${Math.round(playerDistance)}% | AI Distance: ${Math.round(aiDistance)}%`;
  }

  // Reset the game
  function resetGame() {
    playerDistance = 0;
    aiDistance = 0;
    player.style.left = '0%';
    ai.style.left = '0%';
    updateDistanceDisplay();
    lastKey = '';
    isPaused = false;
    currentFrame = 0;
    player.style.backgroundPosition = '0 0'; // Reset to the first frame of the sprite
  }

  // Player keydown event listener
  document.addEventListener('keydown', (event) => {
    const key = event.key.toLowerCase();

    // Pause/unpause the game with "P"
    if (key === 'p') {
      isPaused = !isPaused;
      return; // Stop further processing if we just toggled pause
    }

    // Only process movement keys if the game is not paused
    if (!isPaused && ((key === 'j' && lastKey !== 'j') || (key === 'k' && lastKey !== 'k'))) {
      lastKey = key;
      playerDistance += 1.2;
      player.style.left = `${playerDistance}%`; // Update player position
      updateDistanceDisplay();

      // Update the animation frame for the player
      currentFrame = (currentFrame + 1) % 4; // Cycle through frames 0 to 3
      player.style.backgroundPosition = `-${currentFrame * spriteWidth}px 0px`;

      // Check if the player has won
      if (playerDistance >= goal) {
        alert('Congratulations! You beat the AI!');
        resetGame();
      }
    }
  });

  // Run the AI at a set interval
  const aiInterval = setInterval(aiRun, 100); // AI moves every 100 milliseconds

</script>

</body>
</html>
